{% extends 'base_with_nav.html' %}
{% load static %}

{% load leaflet_tags %}

{% block style %}
{% leaflet_css %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.css" integrity="sha256-46qynGAkLSFpVbEBog43gvNhfrOj+BmwXdxFgVK/Kvc=" crossorigin="anonymous" />
{% endblock %}

{% block title %}
Dashboard
{% endblock %}

{% block content %}
<h1 class="text-center">Dashboard</h1>
<hr>
{% for qrcode in qrcodes %}
    <p>
        {{ qrcode }}
        <ul>
            {% for access in qrcode.access.all %}
                <li>{{ access }}</li>
            {% endfor %}
        </ul>
    </p>
{% endfor %}
{% for access in access_list %}
    <p>
        {{ access }}
    </p>
{% endfor %}
<div class="col-md-6 offset-md-3">
    {% leaflet_map "main" callback="map_init" %}
</div>
{% endblock %}

{% block script %}
{% leaflet_js %}

<script type="text/javascript">
    function map_init(map, options) {
        var redMarker = L.ExtraMarkers.icon({
            icon: 'fa-map-marker-alt',
            markerColor: 'red',
            iconColor: 'blue',
            shape: 'square',
            prefix: 'fa'
        });
        var customMarker = L.ExtraMarkers.icon({
            icon: 'fa-spinner',
            shape: 'circle',
            markerColor: 'red',
            prefix: 'fa',
            extraClasses: 'fa-spin'
        })
        {% for qrcode in qrcodes %}
            L.marker({{ qrcode.coordinates }}, {
                title: 'test',
                icon: customMarker
            }).addTo(map)
        {% endfor %}
<!--        L.marker([lat, lon]).addTo(map);-->
    }
</script>
{% endblock %}